# 스와일러 프로젝트의 기원과 이름 유래

!> 이 페이지는 Swoole 오픈 소스 프로젝트의 창립자 래ngo가 작성한 것으로, 그의 개인적인 견해만을 대표합니다.


## 프로젝트 기원

Swoole 프로젝트의 첫 번째 아이디어는 이전에 작업했던 기업 소프트웨어 프로젝트에서 비롯되었습니다. 당시에는 대략 2010년 말이었고, 회사의 제품에는 사용자가 임의로 이메일 주소를 생성할 수 있어 다른 사용자가 그 이메일 주소에 메일을 보내면 백엔드가 실시간으로 메일 내용을 데이터로 파싱하고 사용자에게 주도적으로 알리도록 하는 요구가 있었습니다. 당시 프로젝트는 PHP로 개발되었으며, 이 요구를 충족시키는 데 어려움을 겪었습니다. PHP는 다른 SMTP 서버에 의존하여 pop3 프로토콜을 사용하여 정기적으로 새로운 메일을 수집하여 완료했는데, 이는 실시간이 아니었습니다. 실시간 시스템을 구현하려면 자체적으로 `TCP 소켓 서버`를 작성하여 `SMTP` 프로토콜을 사용하여 데이터를 수신해야 했습니다. 당시 PHP는 이 분야에서 거의 공백이었고, 성숙한 네트워크 통신 프레임워크가 없었습니다. 요구를 충족시키기 위해 저는 `소켓` 학습부터 `TCP/IP`, IO 멀티플렉싱, `libevent`, 멀티 프로세스에 이르기까지 마침내 이 프로그램을 구현했습니다. 이 프로젝트를 완성한 후, 저는 이 프로그램을 오픈 소스로 공개하고자 했으며, 다른 PHP 개발자들이 이 분야의 어려움을 해결하는 데 도움이 되기를 바랍니다. 이런 프레임워크가 있다면 PHP는 단순히 웹 사이트를 만드는 것에서 더 큰 공간으로 확장될 수 있을 것입니다.


## 성능 문제

또 다른 중요한 이유는 PHP 프로그램의 성능 문제였습니다. 저는 처음에 자바를 공부하며 시작했고, 일하면서 PHP 프로그래머로 전향했습니다. PHP로 프로그램을 개발하는 과정에서 저는 항상 생각해왔습니다. PHP와 Java 비교할 때 가장 큰 장점은 무엇일까요? 간단하고 효율적입니다. PHP는 요청이 완료된 후 모든 자원을 해제하고 메모리를 방출하므로 메모리 누수에 대해 걱정할 필요가 없습니다. 코드의 품질이 높든 낮든 모두 매우 부드럽게 실행됩니다. 그러나 동시에 이것은 PHP의 치명적인 단점입니다. 요청 수가 증가하고 병목 현상이 높아지면 자원을 빠르게 생성하고 곧바로 해제하면 PHP 프로그램의 실행 효율성이 급격히 떨어집니다. 또한 프로젝트의 기능이 점점 복잡해지고 코드가 늘어날수록 PHP에 대한 재앙이 될 것입니다. 이것이 PHP 프레임워크가 PHP 프로그래머들에게 널리 받아들여지지 않았고 Java는 이 문제가 발생하지 않는 이유입니다. 아무리 좋은 프레임워크라도 이러한 비효율적인 방식으로 인해 시스템이 느려질 수 있습니다. 그래서 PHP를 사용하여 PHP 애플리케이션 서버를 개발하기로 결정했습니다. PHP 코드가 메모리에 加载된 후 더 긴 수명을 가지도록 하여, 이렇게 만든 데이터베이스 연결과 다른 큰 객체가 해제되지 않도록 합니다. 각 요청은 매우 적은 양의 코드만 처리해야 하며, 이 코드는 처음 실행될 때만 PHP 해석기로编译되어 메모리에 머물러 있습니다. 또한, 이전에 PHP가 구현할 수 없었던 객체 지속화, 데이터베이스 연결 풀, 캐시 연결 풀도 모두 구현할 수 있습니다. 시스템의 실행 효율성이 크게 향상됩니다.

일정한 시간 동안 연구한 끝에, 현재 이미 초기 구현을 얻었습니다. PHP 자체로 HTTP 서버를 작성하여 독립된 서버 방식으로 실행하고, 단일 프로그램 페이지(객체 생성, 데이터베이스 연결, smarty 템플릿 조작)의 실행 시간이 기존의 0.0x 초에서 0.00x 초로 감소했습니다. Apache AB 병행 100 테스트를 사용했습니다. 전통적인 LAMP 방식보다 초당 요청수가 최소 10배 높았습니다. 제 테스트 기계(Ubuntu10.04 Inter Core E5300 + 2G 메모리)에서 Apache는 83RPS에 불과했지만, Swoole Server는 1150RPS 이상을 달성했습니다.

이 프로젝트가 바로 Swoole의 원시 형태입니다. 이 버전은 2년 이상 유지되었으며, 이 과정에서 점차 경험이 쌓이고 이 기술 방안의 존재하는 문제에 대해 더 깊은 이해를 갖게 되었습니다. 예를 들어 성능이 나쁘고 제약이 많아 운영 체인 인터페이스를 직접 호출할 수 없으며, 메모리 관리 효율이 낮다는 것입니다.


## 텐센트 입사

2011년 말에 저는 텐센트에 입사하여 친구 네트워크의 PHP 플랫폼 개발 작업을 담당했습니다. 놀랍게도 친구 네트워크의 동료들은 이런 생각을 한 뿐만 아니라 실제로 구현했습니다. 친구 네트워크 팀은 이미 생산 환경에서 이 방안을 사용하고 있습니다. 친구 네트워크에는 세 마리 수레가 있습니다. 첫 번째는 PWS로, 이는 순수 PHP로 작성된 WebServer로, 친구 네트워크에는 600여 대의 서버가 PWS에서 실행되고 있으며, Apache, PHP-FPM 등의 프로그램은 전혀 사용되지 않습니다. 두 번째는 SAPS로, 이는 순수 PHP로 개발된 분산 대기열로, 당시에는 대략 150대의 서버 클러스터가 실행되고 있었으며, 많은 이미지 자르기, 프로필 사진 처리, 메시지 동시 전송, 데이터 동기화 등의 로직이 모두 SAPS를 사용하여 논리적으로 비동기화되었습니다. 세 번째는 PSF로, 이는 PHP로 구현된 서버 프레임워크로, 친구 네트워크의 많은 논리 계층 서버는 모두 PSF를 기반으로 구현되었습니다. 대략 300대 정도의 클러스터가 PSF 서버 프로그램을 실행하고 있습니다. 친구 네트워크에서의 이 기간 동안 저는 많은 Linux 기초, 네트워크 통신 지식을 배우고, 대규모 클러스터 고 병목 환경의 네트워크 통신 추적, 디버깅 경험을 쌓았으며, Swoole 개발을 위한 좋은 기초를 마련했습니다.


## Swoole 개발

이 기간 동안 Node.js, Golang 등 훌륭한 기술 방안을 학습하고 이해하게 되었으며, 더 많은 영감을 얻었습니다. 2012년에 새로운 아이디어를 가지게 되어 C 언어로 더 강력하고 기능이 더 큰 버전을 다시 구현하기로 결정했습니다. 이것이 바로 지금의 Swoole 확장입니다.

현재 Swoole는 많은 PHP 기술 팀 tarafından 실제 프로젝트 개발에 사용되고 있으며, 국내외 모두 있습니다. 국내에서는 바이두 주문 센터, 바이두 지도, 텐센트 QQ 공식 계정 및 기업 QQ, 전지 라이브, 360, 당당망, 추위 여행 등이 있습니다. 또한 많은 인공지능, 하드웨어, 게임 프로젝트도 Swoole를 사용하고 있습니다. 또한 Swoole를 기반으로 한 오픈 소스 프레임워크도 점점 더 많아지고 있으며, 예를 들어 TSF, Blink, swPromise 등이 있으며, GitHub에서도 많은 Swoole 관련 프로젝트와 코드를 찾을 수 있습니다.

## 이름 유래

Swoole라는 이름은 영어 단어가 아니며, 제가 창조한 발음이 비슷한 글자입니다. 처음 생각한 이름은 `sword-server`였으며, 이는 광범위한 PHP 개발자들에게 날카로운 칼을 만들어주겠다는 의미였습니다. 나중에 구글도 공상으로 만들어낸 것 같다고 생각하여, 이를 `swoole`라고 명명했습니다.
