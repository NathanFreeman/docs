# Swooleプロジェクトの起源と名前の由来

!> このページはSwooleオープンソースプロジェクトの創始者であるRangoによって書かれ、彼の個人的な見解を代表しています。
## プロジェクトの起源

Swooleプロジェクトの最初のアイデアは、以前に私が従事していた企業ソフトウェアプロジェクトから来ていました。その時はおそらく2010年の終わり頃で、私たちの製品には、ユーザーが自由にメールアドレスを生成し、他のユーザーがこのメールアドレスにメールを送ることができ、バックエンドがリアルタイムでメールの内容を解析してデータを生成し、ユーザーに通知することが必要なという要求がありました。当時のプロジェクトはPHPで開発されており、この要求を実現する際に困難に直面しました。PHPは他のSMTPサーバーに依存し、pop3プロトコルを通じて定期的に新しいメールをチェックして取得することで、リアルタイムではありませんでした。リアルタイムなシステムを実現するためには、自分で`TCP Socket Server`を書いてSMTPプロトコルでデータを受け取る必要がありました。当時、PHPはこの分野でほとんど無であり、成熟したネットワーク通信フレームワークはありませんでした。この要求を実現するために、私はsocketからTCP/IP、IO多重化、libevent、マルチプロセスまで学び、最終的にこのプログラムを実現しました。このプロジェクトを終えた後、私はこのプログラムを開源して、他のPHPerがこの分野の困難を解決するのを助けたかったのです。このようなフレームワークがあれば、PHPは単なるウェブサイトを作るだけでなく、より広い領域に拡張できるでしょう。
## 性能問題

もう一つの重要な理由はPHPプログラムの性能問題です。私は最初はJavaを学んでおり、仕事を始めてからPHPプログラマーになりました。PHPでプログラムを開発する過程で、私は常に考えていました。PHPとJavaの最大の利点は何か？シンプルで効率的です。PHPはリクエストが完了した後、すべてのリソースとメモリを解放し、メモリリークを心配する必要はありません。コードの品質に関わらず、流畅に実行されます。しかし、同時にこれはPHPの致命的な欠点でもあります。リクエストの数が増え、同時接続が高くなると、リソースを迅速に作成し、すぐに解放することで、PHPプログラムの実行効率が急激に低下します。さらに、プロジェクトの機能が複雑になり、コードが増えると、PHPにとっては災害です。これがPHPのフレームワークがPHPプログラマーに広く受け入れられていない理由です。Javaにはこの問題はありません。どんなに良いフレームワークも、このような非効率な方法によって遅くなり、システムが遅くなります。そこで、PHPを使用してPHPのアプリケーションサーバーを開発し、PHPのコードがメモリに読み込まれた後、より長いライフサイクルを持つようにしました。これにより、構築されたデータベース接続やその他の大きなオブジェクトが解放されません。各リクエストは少量のコードのみを処理し、これらのコードはPHPパーサが初めて実行する際に解析され、メモリに滞在します。さらに、以前PHPでは実現できなかった、オブジェクトの持続化、データベース接続プール、キャッシュ接続プールなども実現できます。システムの実行効率は大幅に向上します。

しばらく研究した結果、現在初步的に実現されました。PHP自体を使用してHTTPサーバーを書き、独立したサーバーとして実行し、単一プログラムページ（オブジェクト生成、データベース接続、smartyテンプレート操作）の実行時間が元の0.0x秒から0.00x秒に減少しました。Apache ABで100の同時接続でテストしました。従来のLAMP方式と比較して、リクエスト毎秒が少なくとも10倍以上高くなりました。私のテスト機（Ubuntu10.04 Inter Core E5300 + 2Gメモリ）では、Apacheは83RPSしか走りませんでした。Swoole Serverは1150RPS以上走りました。

このプロジェクトがSwooleの原型です。このバージョンは2年以上間維持され、その過程で徐々にいくつかの経験が蓄積され、この技術ソリューションの存在する問題についてより深い理解を得ました。例えば、性能が悪く、制限が多くオペレーティングシステムのインターフェースを直接呼び出すことができない、メモリ管理の効率が低いなどです。
## 騰訊に入社

2011年の終わりに私は騰訊に入社し、朋友網のPHPプラットフォーム開発を担当しました。驚くべきことに、朋友網の同僚たちはただ考えていただけでなく、実際にそれを実現していました。朋友網チームはすでに生産環境でこのソリューションを使用していました。朋友網には三つの主要な要素があります。最初のものはPWSで、これは純粋にPHPで書かれたWebサーバーで、朋友網のオンラインには600台以上のサーバーがPWS上で実行されており、ApacheやPHP-FPMなどのプログラムは一切使用されていません。2番目のものはSAPSで、これは純粋にPHPで開発された分散キューで、当時約150台のサーバークラスターが稼働しており、多くの画像切り取り、アバター処理、メッセージ同時、データ同期などのロジックがすべてSAPSを使用して論理的异步化されています。3番目のものはPSFで、これはPHPで実現されたサーバーフレームワークで、朋友網の多くのロジック層のサーバーはPSFに基づいて実現されています。約300台のクラスターがPSFサーバープログラムを実行しています。朋友網でのこの期間、私はLinuxの基盤、ネットワーク通信の知識を多く学び、大規模なクラスター高同時接続環境のネットワーク通信追跡、デバッグの経験を多く蓄積し、Swooleの開発のための良い基盤を築きました。
## Swooleの開発

その間にもNode.js、Golangなどの優れた技術ソリューションを学び、さらなるインスピレーションを得ました。2012年には新しいアイデアを持ち、C言語を使用してより強力で機能豊かなバージョンを実現することに決めました。これが現在のSwoole拡張です。

現在、Swooleは多くのPHP技術チームによって実際のプロジェクト開発に使用されており、国内外にいます。国内では百度の注文センター、百度マップ、腾讯QQ公式アカウントと企業QQ、戦旗直播、360、当当網、穷游などが有名です。さらに、多くのIoT、ハードウェア、ゲームプロジェクトでもSwooleが使用されています。また、Swooleに基づくオープンソースフレームワークも増えており、TSF、Blink、swPromiseなどがあり、GitHubでは多くのSwoole関連のプロジェクトとコードを見つけることができます。
## 名前の由来

Swooleという名前は英語の単語ではなく、私が創造した音に近い文字です。最初に思いついた名前は`sword-server`でしたが、これは広大なPHPerに鋭い剣を創造することを意味していました。その後、googleも空から創造されたことに着想を得て、`swoole`と名付けました。
